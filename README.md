# Debris thickness estimation using a surface energy balance model

The model uses high resolution land surface tempertaure maps (LST) to solve a surface energy balance model (sebm) 
for spatially distributed debris thicknesses at various times of a day.

The model follows the princible that all energy fluxes at the earth surface must sum to zero:

S+L(LST)+H(LST)+dS(LST, d)+G(LST, d)=0

S = net shortwave radiation
L = net longwave radiation
H = sensible heat fluxes
dS = rate of change of heat storage
G = ground heat flux
LST = land surface temperature
d = debris thickness


DATA INPUT

1) LST maps
2) DEM
3) Meteorological data (air temperature, wind speed and relative humidity)
4) Other parameters

RUN THE MODEL

To run the model and produce debris thickness maps run both notebooks in following order

1) warming_rate.ipynb

warming_rate.ipynb is a wrapper for the functions in the file sinosoidal_regression.py. It performs a least squares regression of 
a sine function to describe the diurnal tempature variation within a layer of debris, assuming that the mean debris temperature 
equals the arithetric mean of the LST and the assumed debris ice interface temperature of 0Â°C. The warming/cooling rate is then 
generated by first derivative with respect to time. The nootbook wrapper creates a warmingrate folder in the diectory containing
the warmingrate maps for each time. 

2) SEBM_debristhickness.ipynb

Once the warmingrate maps have been created, run SEBM_debristhickness.ipynb. The nootbook is a wrapper for the functions in
energy_balance_model.py. It calulates the individual energy balance components and solves a quadratic equation for debris 
thickness in each pixel. 

SEBM_debristhickness.ipynb